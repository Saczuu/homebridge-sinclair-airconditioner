{
  "pluginAlias": "SinclairPlatform",
  "pluginType": "platform",
  "singular": true,
  "strictValidation": false,
  "schema": {
    "type": "object",
    "required": ["platform", "name", "devices"],
    "properties": {
      "platform": {
        "type": "string",
        "default": "SinclairPlatform",
        "description": "Internal platform type",
        "pattern": "^SinclairPlatform$"
      },
      "name": {
        "type": "string",
        "default": "Sinclair ACs",
        "title": "Platform Name",
        "description": "Name of the platform shown in Homebridge"
      },
      "devices": {
        "type": "array",
        "minItems": 1,
        "description": "List of air conditioner devices",
        "items": {
          "type": "object",
          "required": ["host", "name", "updateInterval"],
          "properties": {
            "name": {
              "type": "string",
              "title": "Device Name",
              "placeholder": "Living Room AC"
            },
            "host": {
              "type": "string",
              "title": "IP Address",
              "format": "ipv4",
              "placeholder": "192.168.1.50"
            },
            "acModel": {
              "type": "string",
              "title": "AC Model",
              "placeholder": "v2"
            },
            "useTargetTempAsCurrent": {
              "type": "boolean",
              "title": "Use target temperature as current",
              "default": false
            },
            "acTempSensorShift": {
              "type": "integer",
              "title": "Temperature Sensor Offset",
              "default": 0
            },
            "updateInterval": {
              "type": "integer",
              "title": "Update Interval (ms)",
              "minimum": 1000,
              "default": 10000
            }
          }
        }
      }
    }
  },
  "layout": [
    { "key": "name", "title": "Platform Name:" },
    {
      "type": "array",
      "key": "devices",
      "title": "Devices",
      "buttonText": "Add device",
      "expandable": true,
      "expanded": false,
      "items": [
        {
          "type": "div",
          "displayFlex": true,
          "flex-flow": "row wrap",
          "items": [
            {
              "key": "devices[].name",
              "flex": "1 1 50%",
              "title": "Device Name"
            },
            {
              "key": "devices[].host",
              "flex": "1 1 50%",
              "title": "IP Address"
            },
            {
              "key": "devices[].acModel",
              "flex": "1 1 50%",
              "title": "AC Model",
              "condition": {
                "functionBody": "return /^([0-9]{1,3}\\.){3}[0-9]{1,3}$/.test(model.devices[arrayIndices].host);"
              }
            },
            {
              "key": "devices[].updateInterval",
              "flex": "1 1 50%",
              "title": "Update Interval (ms)",
              "condition": {
                "functionBody": "return /^([0-9]{1,3}\\.){3}[0-9]{1,3}$/.test(model.devices[arrayIndices].host);"
              }
            },
            {
              "key": "devices[].acTempSensorShift",
              "flex": "1 1 50%",
              "title": "Temperature Sensor Offset",
              "condition": {
                "functionBody": "return /^([0-9]{1,3}\\.){3}[0-9]{1,3}$/.test(model.devices[arrayIndices].host);"
              }
            },
            {
              "key": "devices[].useTargetTempAsCurrent",
              "flex": "1 1 100%",
              "title": "Use Target Temperature as Current",
              "condition": {
                "functionBody": "return /^([0-9]{1,3}\\.){3}[0-9]{1,3}$/.test(model.devices[arrayIndices].host);"
              }
            }
          ]
        }
      ]
    }
  ]
}
